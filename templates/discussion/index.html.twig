{% extends 'base.html.twig' %}

{% block title %}Discussion{% endblock %}

{% block body %}
    <h1>Discussion</h1>

    <h2>Posts</h2>
    <ul>
        {% for post in posts %}
            <li>
                <h3>{{ post.titre }}</h3>
                <p>{{ post.contenu }}</p>
                <p><small>Posté par {{ post.auteur.nom }} le {{ post.dateCreation|date('d/m/Y H:i') }}</small></p>

                <h4>Commentaires</h4>
                <ul>
                    {% for commentaire in post.commentaires %}
                        <li>
                            <p>{{ commentaire.contenu }}</p>
                            <p><small>Posté par {{ commentaire.auteur.nom }} le {{ commentaire.dateCreation|date('d/m/Y H:i') }}</small></p>
                        </li>
                    {% endfor %}
                </ul>
            </li>
        {% endfor %}
    </ul>

    <h2>Événements</h2>
    <ul>
        {% for evenement in evenements %}
            <li>
                <h3>{{ evenement.contenu }}</h3>
                <p>Lieu : {{ evenement.lieu }}</p>
                <p>Début : {{ evenement.dateDebut|date('d/m/Y H:i') }}</p>
                <p>Fin : {{ evenement.dateFin|date('d/m/Y H:i') }}</p>
                <p><small>Posté par {{ evenement.auteur.nom }} le {{ evenement.dateCreation|date('d/m/Y H:i') }}</small></p>
                {% if is_granted('ROLE_ADMIN') or is_granted('ROLE_MODERATEUR') %}
                    <a href="{{ path('app_evenement_edit', {'id': evenement.id}) }}" class="btn btn-secondary">Modifier</a>
                    <a href="{{ path('app_evenement_delete', {'id': evenement.id}) }}" class="btn btn-danger" onclick="return confirm('Êtes-vous sûr de vouloir supprimer cet événement ?');">Supprimer</a>
                {% endif %}
            </li>
        {% endfor %}
    </ul>

    {% if is_granted('ROLE_ADMIN') or is_granted('ROLE_MODERATEUR') %}
        <a href="{{ path('app_evenement_create') }}" class="btn btn-primary">Créer un événement</a>
    {% endif %}
{% endblock %}
